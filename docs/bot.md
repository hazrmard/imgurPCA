# imgurpca.Bot  
`Bot` class acts on behalf of a user. It operates in 2 modes: Authenticated and
Anonymous. If credentials are loaded or obtained using pin authorization, then
`Bot` is Authenticated. `Bot` exposes the entire API of imgurpython through
`Bot.client` which is an `ImgurClient` instance. Bot is subclassed from
`base.Electronic`.  

### Attributes
```
- auth_url (str):
    The URL where a user can obtain a pin to feed to authorize() to obtain
    access and refresh tokens.

- anon (bool):
    Whether or not bot is anonymous(True) or authenticated (False).

- access_token (str):
    The access token for authentication. Either provided at instantiation,
    loaded from credential file, or obtained through pin from authorize().

- refresh_token (str):
    The refresh token for authentication. Either provided at instantiation,
    loaded from credential file, or obtained through pin from authorize().

- cs (str):
    The client secret. Set at instantiation if provided.

- cid (str):
    The client id. Set at instantiation if provided.

- client (ImgurClient):
    An instance of imgurpython.ImgurClient. Exposes entire imgurpython API.
```

### Instantiation
```python
def __init__(self, *args, **kwargs):
# Example
from imgurpca import Bot
b = Bot(cs='client secret', cid='client id')
b = Bot(client=an_ImgurClient, access_token='blah', refresh_token='blah')
```
```
Parameters:
- access_token (str):
    OPTIONAL. Provide if available, or use load_credentials() or authorize().
    If given with 'refresh_token', authenticates the bot.

- refresh_token (str)
    OPTIONAL. Provide if available, or use load_credentials() or authorize().
    If given with 'access_token', authenticates the bot.

- cid (string):
   Client ID, use with 'cs'.

- cs (string):
   Client secret, use with 'cid'.

OR:
- client (ImgurClient):
   imgurpython.ImgurClient instance. Use instead of 'cs' and 'cid'.
```

### authorize
Given the pin obtained from `Bot.auth_url`, authenticates bot by getting
access and refresh tokens.
```python
def authorize(self, pin, credfile=None):
# Example
b.authorize(pin=PIN_FROM_AUTH_URL)
```
```
Parameters:
- pin (str):
    Pin obtained from auth_url.

- credfile (str):
    OPTIONAL. File to store access and refresh tokens in for later use. Then
    load_credentials() can be used with credfile.
```

### load_credentials
Acquire access and refresh token from a credential file generated by
`authorize()`. This authenticates the bot.
```python
def load_credentials(self, credfile):
# Example
b.load_credentials('my.cred')
```
```
Parameters:
- credfile (str):
    Name of file containing tokens. First line is access token. Second line
    is refresh token.
```

### every
Scheduling function. Specify an interval to perform periodic tasks.
```python
def every(self, interval):
# Example
b.every(Bot.MINUTE)
```
```
Parameters:
- interval (int):
    An interval value. Any combination of:
        * Bot.MINUTE,
        * Bot.HOUR,
        * Bot.DAY,
        * Bot.WEEK

Returns a reference to self so scheduling functions can be chained.
```

### do
Scheduling function. Specify a function to execute periodically.
```python
def do(self, func):
# Example
def f(bot_instance):
    bot_instance.get_notifications()
b.do(f)
```
```
Parameters:
- funct (func):
    A function object to call.

Returns a reference to self so scheduling functions can be chained.
```

### using
Scheduling function. Specify arguments to provide to the function in `do()`.
```python
def using(self, args):
# Example
b.using([b])    # give itself as an argument to function
```
```
Parameters:
- args (list/tuple):
    A list of arguments to provide to function in do().

Returns a reference to self so scheduling functions can be chained.
```

### until
Scheduling function. An ending time in epoch seconds. If not called, task
continues forever.
```python
def until(self, when):
# Example
import time
b.until(time.time()+Bot.HOUR)
```
```
Parameters:
- when (int):
    Time to finish execution in epoch seconds.

Returns a reference to self so scheduling functions can be chained.
```

### go
Scheduling function. Start execution in a new thread. Call after `every`,
`do`, `using`, and `until`.
```python
def go(self):
# Example
b.go()
b.every(Bot.MINUTE).do(f).using([b]).until(time.time()+Bot.HOUR).go()
```

### stop
Scheduling function. Stop periodic task from main thread. Task stops after
the next time its thread wakes and checks for `stop`.
```python
def stop(self, force=False):
# Example
b.stop()
b.stop(force=True)      # interrupts task and stops it.
```
```
Parameters:
- force (bool):
    Whether to interrupt task to abort it, or wait for it to come out of
    sleep.
```

### upload_image
Upload image to imgur from either a URL or filepath.
```python
def upload_image(self, imgpath, share=False, **kwargs):
# Example
res = b.upload_image('myimage.jpg', share=True, title='My Image')
```
```
Parameters:
- imgpath (str):
    Local path or URL to image file

- share (bool):
    Whether to post to gallery. Only if Authenticated.

- title (str):
    OPTIONAL. Title of post

- description (str):
    OPTIONAL. Description of post

- album (str):
    OPTIONAL. Album id to add image to. Or delete hash in case anonymous.

- name (str):
    OPTIONAL. Name of image file.

See ImgurClient.allowed_image_fields for allowed keywords.

Returns a dict containing image location, id, title etc.
```

### delete_image
Deletes an image from imgur.
```python
def delete_image(self, img_id):
# Example
del_res = b.delete_image(res['id'])     # res is response from upload_image
```
```
Parameters:
- img_id (str):
    ID of image (if bot is authenticated) or delete hash (if bot is
    anonymous). ID and delete hash are contained in the dict returned from
    upload_image().

Returns boolean indicating success.
```

### share
Put an already uploaded image on imgur gallery.
```python
def share(self, post_id, title=''):
# Example
b.share(res['id'], )                    # res is response from upload_image
```
```
Parameters:
- post_id (str):
    ID of post/image to share.

- title (str):
    Title to give to shared post.

Returns boolean indicating success.
```

### unshare
Remove an already uploaded/shared image from imgur gallery.
```python
def unshare(self, post_id):
# Example
b.unshare(res['id'], )                  # res is response from upload_image
```
```
Parameters:
- post_id (str):
    ID of post/image to share.

Returns boolean indicating success.
```

### upvote / downvote
Post an upvote or downvote on shared post.
```python
def upvote(self, post_id):
def downvote(self, post_id):
# Example
b.upvote(res['id'])                     # res is response from upload_image
```
```
Parameters:
- post_id (str):
    ID of post/image to share.

Returns boolean indicating success.
```

### get_notifications
Get notifications to account.
```python
def get_notifications(self, new=True, markread=True):
# Example
n = b.get_notifications(new=True, markread=False)
# Note: currently markread=True gives a 400 error.
```
```
Parameters:
- new (bool):
    Only get unread notifications.

- markread (bool):
    Mark downloaded notifications as read.

Returns a dictionary with keys 'messages' and 'replies'. Messages and
replies are of the notification data model. Notification.content is
a comment object for replies and a message object for messages. See imgur
API data models for details.
```

### post_comment
Post a comment on a gallery post.
```python
def post_comment(self, post_id, comment):
# Example
comment_id_dict = b.post_comment(POST_ID, 'Hi this is a comment.')
```
```
Parameters:
- post_id (str):
    Id of post on gallery.

- comment (str):
    Comment body.

Returns API response as a dict containing comment id in field 'id'.
```

### post_reply
Post a reply to a comment.
```python
def post_reply(self, comment_id, post_id, comment):
# Example
b.post_reply(COMMENT_ID, POST_ID, 'This is a reply')
```
```
Parameters:
- comment_id (str):
    Id of comment to reply to.

- post_id (str):
    Id of post on gallery containing the comment.

- comment (str):
    Comment body.

Returns API response as a dict containing reply id.
```

### send_message
Send a direct message to a user.
```python
def send_message(self, recipient, message):
# Example
b.send_message('some username', 'Hello there!')
```
```
Parameters:
- recipient (str):
    Target username.

- message (str):
    Message body.

Returns API response: a boolean to indicate success.
```

### conversation_list
Get a list of conversations with previews of the most recent messages.
```python
def conversation_list(self):
# Example:
lst = b.conversation_list()
```
```
Parameters:

Returns a list of conversation objects. Conversation objects only contain
portion of the last message from the other user. For more messages, use
get_conversation() to get a single conversation thread. See imgue API data
model for conversation object attributes.
```

### get_conversation
Get messages from a particular conversation.
```python
def get_conversation(self, conv_id, page=1):
# Example
id = lst[0].id          # lst is conv list from above
conv = b.get_conversation(id)
```
```
Parameters:
- conv_id (str):
    Conversation id.

- page (int):
    Page number of conversation. Starts from 1.

Returns a conversation object with messages stored in messages attribute.
Messages are message objects (see API data model)
```
